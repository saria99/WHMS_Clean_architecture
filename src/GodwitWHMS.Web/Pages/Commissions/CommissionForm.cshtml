@page "{rowGuid?}"
@using GodwitWHMS.Domain.Models.Enums
@model GodwitWHMS.Pages.Commissions.CommissionFormModel
@{
    Layout = "~/Pages/Shared/Dashmin/_Admin.cshtml";
    var statusMessage = Model.StatusMessage;
    Model.StatusMessage = string.Empty;
}

<div class="form-card" id="formcard">
    <div class="m-2">
        <form id="formMain" method="post" novalidate="">
            <input type="hidden" asp-for="@Model.CommissionForm.RowGuid" />
            <input type="hidden" asp-for="@Model.CommissionForm.Id" />
            <div class="form-card-body">
                <div>
                    <ul class="nav nav-tabs nav-tabs-sm" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link rounded-0 text-body active" id="general-tab" data-bs-toggle="tab" data-bs-target="#general" type="button" role="tab" aria-controls="general" aria-selected="true">General</button>
                        </li>
                    </ul>
                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="general" role="tabpanel" aria-labelledby="general-tab">
                            <p class="small-italic-left">General</p>
                            <fieldset>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label asp-for="@Model.CommissionForm.ServiceType" class="form-label"></label>
                                            <input asp-for="@Model.CommissionForm.ServiceType" class="form-control" readonly />
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label asp-for="@Model.CommissionForm.CommissionPercentage" class="form-label"></label>
                                            <input asp-for="@Model.CommissionForm.CommissionPercentage" class="form-control" />
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label asp-for="@Model.CommissionForm.EffectiveDate" class="form-label"></label>
                                            <input asp-for="@Model.CommissionForm.EffectiveDate" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-card-footer">
                <button type="submit" id="btnSubmit" class="e-btn e-control">Submit</button>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            showStatusMessage('@statusMessage');

            new ej.inputs.NumericTextBox({ format: 'N2', min: 0.0 }, '#CommissionForm_CommissionPercentage');
            new ej.inputs.DatePicker({ value: new Date() }, '#CommissionForm_EffectiveDate');
            new ej.inputs.TextBox({}, '#CommissionForm_ServiceType');
            new ej.buttons.Button({ isPrimary: true }, '#btnSubmit');

            var validationOptions = {
                rules: {
                    'CommissionForm.CommissionPercentage': { required: true },
                    'CommissionForm.EffectiveDate': { required: true }
                }
            }

            var formValidator = new ej.inputs.FormValidator('#formMain', validationOptions);
            var formElement = document.getElementById('formMain');
            formElement.addEventListener('submit', function (e) {
                e.preventDefault();
                if (formValidator.validate()) {
                    formElement.submit();
                }
            });
        });
    </script>
}

