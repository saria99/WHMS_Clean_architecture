@page
@model GodwitWHMS.Pages.BasePrices.TotalPriceListModel
@{
    Layout = "~/Pages/Shared/Dashmin/_Admin.cshtml";
    var statusMessage = Model.StatusMessage;
    Model.StatusMessage = string.Empty;
}

<div class="row">
    <div class="col-12">
        <div id="Grid"></div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            showStatusMessage('@statusMessage');

            var grid = new ej.grids.Grid({
                height: getDashminGridHeight(),
                dataSource: new ej.data.DataManager({
                    url: '/odata/CalculatedPrice',
                    adaptor: new ej.data.ODataV4Adaptor()
                }),
                allowFiltering: true,
                allowSorting: true,
                allowSelection: true,
                allowGrouping: true,
                allowTextWrap: true,
                allowResizing: true,
                allowPaging: true,
                allowExcelExport: true,
                filterSettings: { type: 'CheckBox' },
                sortSettings: { columns: [{ field: 'TotalPrice', direction: 'Ascending' }] },
                pageSettings: { currentPage: 1, pageSize: 50, pageSizes: ["10", "20", "50", "100", "200", "All"] },
                selectionSettings: { persistSelection: true, type: 'Single' },
                autoFit: true,
                showColumnMenu: true,
                gridLines: 'Horizontal',
                columns: [
                    { type: 'checkbox', width: 60 },
                    { field: 'Id', isPrimaryKey: true, headerText: 'Id', visible: false },
                    { field: 'CarrierName', headerText: 'Carrier Name', width: 150 },
                    { field: 'ServiceType', headerText: 'Service Type', width: 150 },
                    { field: 'OriginCountryName', headerText: 'Origin Country', width: 150 },
                    { field: 'DestinationCountryName', headerText: 'Destination Country', width: 150 },
                    { field: 'PriceWithFuelSurcharge', headerText: 'Price With Fuel Surcharge', width: 150, format: 'C2', textAlign: 'Right' },
                    { field: 'TotalPrice', headerText: 'Total Price', width: 150, format: 'C2', textAlign: 'Right' },
                    { field: 'IsCheapest', headerText: 'Cheapest', width: 100, type: 'boolean', displayAsCheckBox: true, textAlign: 'Center' }
                ],
                toolbar: [
                    'ExcelExport', 'Search',
                    { type: 'Separator' },
                    { text: 'Calculate Prices', tooltipText: 'Calculate Prices', prefixIcon: 'e-refresh', id: 'CalculatePrices' }
                ],
                toolbarClick: (args) => {
                    if (args.item.id === 'Grid_excelexport') {
                        grid.excelExport();
                    }
                }
            });

            grid.appendTo('#Grid');
        });
    </script>
}
